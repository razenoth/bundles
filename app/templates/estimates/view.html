{% extends 'base.html' %}
{% block content %}
<h2>Estimate #{{ estimate.id }}</h2>
<p><strong>Customer:</strong> {{estimate.customer_name}} — {{estimate.customer_address}}</p>

<input id="item-search" class="form-control" placeholder="Search products or bundles…">
<ul id="search-results" class="list-group position-absolute" style="z-index:1000;"></ul>

<table class="table mt-4" id="line-items">
  <thead><tr>
    <th>Description</th><th>Qty</th><th>Unit Price</th><th>Notes</th><th>Actions</th>
  </tr></thead>
  <tbody>
    {% for i in estimate.items %}
    <tr data-item-id="{{ i.id }}">
      <td>{{ i.description }}</td>
      <td><input type="number" value="{{ i.quantity }}" data-field="quantity"></td>
      <td><input type="text"   value="{{ i.unit_price }}" data-field="unit_price"></td>
      <td><input type="text"   value="{{ i.notes }}"      data-field="notes"></td>
      <td><button class="btn btn-sm btn-danger remove-item">&times;</button></td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<script>const estimateId = {{estimate.id}};</script>
<script src="{{ url_for('static', filename='js/estimates.js') }}"></script>
{% endblock %}
